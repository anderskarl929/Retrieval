<!DOCTYPE html>
<html lang="sv">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>1X2 √ñvningsfr√•gor - Historia</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .container {
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            max-width: 800px;
            width: 100%;
            padding: 40px;
        }

        h1 {
            color: #667eea;
            text-align: center;
            margin-bottom: 30px;
            font-size: 2em;
        }

        .upload-section {
            text-align: center;
            padding: 40px;
            border: 3px dashed #667eea;
            border-radius: 15px;
            margin-bottom: 30px;
            background: #f8f9ff;
        }

        .upload-section h2 {
            color: #555;
            margin-bottom: 20px;
        }

        input[type="file"] {
            display: none;
        }

        .upload-btn {
            background: #667eea;
            color: white;
            padding: 15px 40px;
            border: none;
            border-radius: 10px;
            font-size: 1.1em;
            cursor: pointer;
            transition: all 0.3s;
        }

        .upload-btn:hover {
            background: #5568d3;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .quiz-section {
            display: none;
        }

        .progress-bar {
            background: #e0e0e0;
            height: 10px;
            border-radius: 5px;
            margin-bottom: 30px;
            overflow: hidden;
        }

        .progress-fill {
            background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
            height: 100%;
            width: 0%;
            transition: width 0.3s ease;
        }

        .question-counter {
            text-align: center;
            color: #666;
            margin-bottom: 20px;
            font-size: 1.1em;
        }

        .question-box {
            background: #f8f9ff;
            padding: 30px;
            border-radius: 15px;
            margin-bottom: 25px;
        }

        .question-text {
            font-size: 1.3em;
            color: #333;
            margin-bottom: 25px;
            line-height: 1.6;
        }

        .options {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .option {
            background: white;
            border: 2px solid #ddd;
            padding: 20px;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 1.1em;
        }

        .option:hover {
            border-color: #667eea;
            transform: translateX(5px);
        }

        .option.selected {
            border-color: #667eea;
            background: #f0f4ff;
        }

        .option.correct {
            background: #d4edda;
            border-color: #28a745;
            cursor: default;
        }

        .option.incorrect {
            background: #f8d7da;
            border-color: #dc3545;
            cursor: default;
        }

        .option.disabled {
            cursor: not-allowed;
            opacity: 0.7;
        }

        .feedback {
            margin-top: 20px;
            padding: 15px;
            border-radius: 10px;
            font-size: 1.1em;
            text-align: center;
            display: none;
        }

        .feedback.correct {
            background: #d4edda;
            color: #155724;
            border: 2px solid #28a745;
        }

        .feedback.incorrect {
            background: #f8d7da;
            color: #721c24;
            border: 2px solid #dc3545;
        }

        .next-btn {
            background: #667eea;
            color: white;
            padding: 15px 40px;
            border: none;
            border-radius: 10px;
            font-size: 1.1em;
            cursor: pointer;
            margin-top: 20px;
            display: none;
            transition: all 0.3s;
        }

        .next-btn:hover {
            background: #5568d3;
            transform: translateY(-2px);
        }

        .results-section {
            display: none;
            text-align: center;
        }

        .score-display {
            font-size: 3em;
            color: #667eea;
            margin: 30px 0;
            font-weight: bold;
        }

        .score-message {
            font-size: 1.5em;
            color: #555;
            margin-bottom: 30px;
        }

        .restart-btn {
            background: #28a745;
            color: white;
            padding: 15px 40px;
            border: none;
            border-radius: 10px;
            font-size: 1.1em;
            cursor: pointer;
            transition: all 0.3s;
        }

        .restart-btn:hover {
            background: #218838;
            transform: translateY(-2px);
        }

        .instructions {
            background: #fff3cd;
            border: 2px solid #ffc107;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            color: #856404;
        }

        .instructions strong {
            display: block;
            margin-bottom: 10px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üìö Historia - √ñvningsfr√•gor</h1>

        <div class="upload-section" id="uploadSection">
            <h2>Ladda upp din fr√•gefil</h2>
            <div class="instructions">
                <strong>CSV-format:</strong>
                Fr√•ga, Alternativ 1, Alternativ 2, Alternativ 3, R√§tt svar (1/2/3)
            </div>
            <input type="file" id="fileInput" accept=".csv">
            <label for="fileInput">
                <button class="upload-btn" onclick="document.getElementById('fileInput').click()">
                    V√§lj CSV-fil
                </button>
            </label>
        </div>

        <div class="quiz-section" id="quizSection">
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
            </div>
            <div class="question-counter" id="questionCounter"></div>
            <div class="question-box">
                <div class="question-text" id="questionText"></div>
                <div class="options" id="optionsContainer"></div>
                <div class="feedback" id="feedback"></div>
                <button class="next-btn" id="nextBtn">N√§sta fr√•ga ‚Üí</button>
            </div>
        </div>

        <div class="results-section" id="resultsSection">
            <h2>üéâ Quiz Klar!</h2>
            <div class="score-display" id="scoreDisplay"></div>
            <div class="score-message" id="scoreMessage"></div>
            <button class="restart-btn" onclick="location.reload()">B√∂rja om</button>
        </div>
    </div>

    <script>
        let questions = [];
        let currentQuestion = 0;
        let score = 0;
        let answered = false;

        document.getElementById('fileInput').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(event) {
                    parseCSV(event.target.result);
                };
                reader.readAsText(file);
            }
        });

        function parseCSV(csvText) {
            const lines = csvText.trim().split('\n');
            questions = [];

            for (let i = 0; i < lines.length; i++) {
                const line = lines[i].trim();
                if (line) {
                    // Split by comma but respect quoted fields
                    const parts = line.match(/(".*?"|[^",]+)(?=\s*,|\s*$)/g);
                    if (parts && parts.length >= 5) {
                        const question = {
                            text: parts[0].replace(/^"|"$/g, '').trim(),
                            options: [
                                parts[1].replace(/^"|"$/g, '').trim(),
                                parts[2].replace(/^"|"$/g, '').trim(),
                                parts[3].replace(/^"|"$/g, '').trim()
                            ],
                            correct: parseInt(parts[4].replace(/^"|"$/g, '').trim()) - 1
                        };
                        questions.push(question);
                    }
                }
            }

            if (questions.length > 0) {
                startQuiz();
            } else {
                alert('Kunde inte l√§sa n√•gra fr√•gor fr√•n filen. Kontrollera formatet.');
            }
        }

        function startQuiz() {
            document.getElementById('uploadSection').style.display = 'none';
            document.getElementById('quizSection').style.display = 'block';
            showQuestion();
        }

        function showQuestion() {
            answered = false;
            const question = questions[currentQuestion];
            
            document.getElementById('questionCounter').textContent = 
                `Fr√•ga ${currentQuestion + 1} av ${questions.length}`;
            
            document.getElementById('questionText').textContent = question.text;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            
            question.options.forEach((option, index) => {
                const optionDiv = document.createElement('div');
                optionDiv.className = 'option';
                optionDiv.textContent = option;
                optionDiv.onclick = () => selectAnswer(index);
                optionsContainer.appendChild(optionDiv);
            });

            document.getElementById('feedback').style.display = 'none';
            document.getElementById('nextBtn').style.display = 'none';
            
            updateProgress();
        }

        function selectAnswer(selectedIndex) {
            if (answered) return;
            
            answered = true;
            const question = questions[currentQuestion];
            const options = document.querySelectorAll('.option');
            const feedback = document.getElementById('feedback');
            
            options.forEach(option => option.classList.add('disabled'));
            
            if (selectedIndex === question.correct) {
                options[selectedIndex].classList.add('correct');
                feedback.className = 'feedback correct';
                feedback.textContent = '‚úì R√§tt svar!';
                score++;
            } else {
                options[selectedIndex].classList.add('incorrect');
                options[question.correct].classList.add('correct');
                feedback.className = 'feedback incorrect';
                feedback.textContent = '‚úó Fel svar. R√§tt svar markerat i gr√∂nt.';
            }
            
            feedback.style.display = 'block';
            document.getElementById('nextBtn').style.display = 'block';
        }

        function updateProgress() {
            const progress = ((currentQuestion + 1) / questions.length) * 100;
            document.getElementById('progressFill').style.width = progress + '%';
        }

        document.getElementById('nextBtn').addEventListener('click', function() {
            currentQuestion++;
            if (currentQuestion < questions.length) {
                showQuestion();
            } else {
                showResults();
            }
        });

        function showResults() {
            document.getElementById('quizSection').style.display = 'none';
            document.getElementById('resultsSection').style.display = 'block';
            
            const percentage = Math.round((score / questions.length) * 100);
            document.getElementById('scoreDisplay').textContent = 
                `${score} / ${questions.length} (${percentage}%)`;
            
            let message = '';
            if (percentage === 100) {
                message = 'üåü Perfekt! Du har full koll!';
            } else if (percentage >= 80) {
                message = 'üëè Mycket bra jobbat!';
            } else if (percentage >= 60) {
                message = 'üëç Bra k√§mpat!';
            } else {
                message = 'üìñ Forts√§tt √∂va, du l√§r dig mer f√∂r varje g√•ng!';
            }
            
            document.getElementById('scoreMessage').textContent = message;
        }
    </script>
</body>
</html>
